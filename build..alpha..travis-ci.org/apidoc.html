<div class="apidocDiv">
<style>
/*csslint
*/
.apidocDiv {
    background: #fff;
    font-family: Arial, Helvetica, sans-serif;
}
.apidocDiv a[href] {
    color: #33f;
    font-weight: bold;
    text-decoration: none;
}
.apidocDiv a[href]:hover {
    text-decoration: underline;
}
.apidocCodeCommentSpan {
    background: #bbf;
    color: #000;
    display: block;
}
.apidocCodeKeywordSpan {
    color: #d00;
    font-weight: bold;
}
.apidocCodePre {
    background: #eef;
    border: 1px solid;
    color: #777;
    padding: 5px;
    white-space: pre-wrap;
}
.apidocFooterDiv {
    margin-top: 20px;
    text-align: center;
}
.apidocModuleLi {
    margin-top: 10px;
}
.apidocSectionDiv {
    border-top: 1px solid;
    margin-top: 20px;
}
.apidocSignatureSpan {
    color: #777;
    font-weight: bold;
}
</style>
<h1>api documentation for
    <a

        href="https://github.com/martintajur/node-mysql-activerecord"

    >mysql-activerecord (v0.8.6)</a>
</h1>
<h4>A lightweight MySQL query builder on top of the node-mysql module.</h4>
<div class="apidocSectionDiv"><a
    href="#apidoc.tableOfContents"
    id="apidoc.tableOfContents"
><h1>table of contents</h1></a><ol>

    <li class="apidocModuleLi"><a href="#apidoc.module.mysql-activerecord">module mysql-activerecord</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.mysql-activerecord.Adapter">
            function <span class="apidocSignatureSpan">mysql-activerecord.</span>Adapter
            <span class="apidocSignatureSpan">(settings)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.mysql-activerecord.Pool">
            function <span class="apidocSignatureSpan">mysql-activerecord.</span>Pool
            <span class="apidocSignatureSpan">(settings)</span>
            </a>

        </li>

    </ol></li>

</ol></div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.mysql-activerecord" id="apidoc.module.mysql-activerecord">module mysql-activerecord</a></h1>


    <h2>
        <a href="#apidoc.element.mysql-activerecord.Adapter" id="apidoc.element.mysql-activerecord.Adapter">
        function <span class="apidocSignatureSpan">mysql-activerecord.</span>Adapter
        <span class="apidocSignatureSpan">(settings)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">Adapter = function (settings) {

	var mysql = require(&#x27;mysql&#x27;);

	var initializeConnectionSettings = function () {
		if(settings.server) {
			settings.host = settings.server;
		}
		if(settings.username) {
			settings.user = settings.username;
		}

		if (!settings.host) {
			throw new Error(&#x27;Unable to start mysql-activerecord - no server given.&#x27;);
		}
		if (!settings.port) {
			settings.port = 3306;
		}
		if (!settings.user) {
			settings.user = &#x27;&#x27;;
		}
		if (!settings.password) {
			settings.password = &#x27;&#x27;;
		}
		if (!settings.database) {
			throw new Error(&#x27;Unable to start mysql-activerecord - no database given.&#x27;);
		}

		return settings;
	};

	var connection;
	var connectionSettings;
	var pool;

	if (settings &#x26;&#x26; settings.pool) {
		pool = settings.pool.pool;
		connection = settings.pool.connection;
	} else {
		connectionSettings = initializeConnectionSettings();
		connection = new mysql.createConnection(connectionSettings);
	}

	if (settings.charset) {
		connection.query(&#x27;SET NAMES &#x27; + settings.charset);
	}

	var whereClause = {},
		selectClause = [],
		orderByClause = &#x27;&#x27;,
		groupByClause = &#x27;&#x27;,
		havingClause = &#x27;&#x27;,
		limitClause = -1,
		offsetClause = -1,
		joinClause = [],
		lastQuery = &#x27;&#x27;;
	
	var resetQuery = function(newLastQuery) {
		whereClause = {};
		selectClause = [];
		orderByClause = &#x27;&#x27;;
		groupByClause = &#x27;&#x27;;
		havingClause = &#x27;&#x27;,
		limitClause = -1;
		offsetClause = -1;
		joinClause = [];
		lastQuery = (typeof newLastQuery === &#x27;string&#x27; ? newLastQuery : &#x27;&#x27;);
		rawWhereClause = {};
		rawWhereString = {};
	};
	
	var rawWhereClause = {};
	var rawWhereString = {};
	
	var escapeFieldName = function(str) {
		return (typeof rawWhereString[str] === &#x27;undefined&#x27; &#x26;&#x26; typeof rawWhereClause[str] === &#x27;undefined&#x27; ? &#x27;`&#x27; + str.replace(&#x27;.&#x27;,&#x27;`.`&#x27;) + &#x27;`&#x27; :
str);
	};
	
	var buildDataString = function(dataSet, separator, clause) {
		if (!clause) {
			clause = &#x27;WHERE&#x27;;
		}
		var queryString = &#x27;&#x27;, y = 1;
		if (!separator) {
			separator = &#x27;, &#x27;;
		}
		var useSeparator = true;
		
		var datasetSize = getObjectSize(dataSet);
		
		for (var key in dataSet) {
			useSeparator = true;
			
			if (dataSet.hasOwnProperty(key)) {
				if (clause == &#x27;WHERE&#x27; &#x26;&#x26; rawWhereString[key] == true) {
					queryString += key;
				}
				else if (dataSet[key] === null) {
					queryString += escapeFieldName(key) + (clause == &#x27;WHERE&#x27; ? &#x22; is NULL&#x22; : &#x22;=NULL&#x22;);
				}
				else if (typeof dataSet[key] !== &#x27;object&#x27;) {
					queryString += escapeFieldName(key) + &#x22;=&#x22; + connection.escape(dataSet[key]);
				}
				else if (typeof dataSet[key] === &#x27;object&#x27; &#x26;&#x26; Object.prototype.toString.call(dataSet[key]) === &#x27;[object Array]&#x27; &#x26;&#x26; dataSet[key
].length &#x3e; 0) {
					queryString += escapeFieldName(key) + &#x27; in (&#x22;&#x27; + dataSet[key].join(&#x27;&#x22;, &#x22;&#x27;) + &#x27;&#x22;)&#x27;;
				}
				else {
					useSeparator = false;
					datasetSize = datasetSize - 1;
				}
				
				if (y &#x3c; datasetSize &#x26;&#x26; useSeparator) {
					queryString += separator;
					y++;
				}
			}
		}
		if (getObjectSize(dataSet) &#x3e; 0) {
			queryString = &#x27; &#x27; + clause + &#x27; &#x27; + queryString;
		}
		return queryString;
	};

	var buildJoinString = function() {
		var joinString = &#x27;&#x27;;

		for (var i = 0; i &#x3c; joinClause.length; i++) {
			joinString += (joinClause[i].direction !== &#x27;&#x27; ? &#x27; &#x27; + joinClause[i].direction : &#x27;&#x27;) + &#x27; JOIN &#x27; + escapeFieldName(joinClause[i
].table) + &#x27; ON &#x27; + joinClause[i].relation;
		}

		return joinString;
	};

	var mergeObjects = function() {
		for (var i = 1; i &#x3c; arguments.length; i++) {
			for (var key in arguments[i]) {
				if (arguments[i].hasOwnProperty(key)) {
					arguments[0][key] = arguments[i][key];
				}
			}
		}
		return arguments[0];
	};

	var getObjectSize = function(object) {
		var size = 0;
		for (var key in object) {
			if (object.hasOwnProperty(key)) {
				size++;
			}
		}
		return size;
	};

	var trim = function (s) {
		var l = 0, r = s.length - 1;
		while (l &#x3c; s.length &#x26;&#x26; s[l] == &#x27; &#x27;) {
			l++;
		}
		while (r &#x3e; l &#x26;&#x26; s[r] == &#x27; &#x27;) {
			r-=1;
		}
		return s.substring(l, r + 1);
	};

	this.connectionSettings = function() { return connectionSettings; };
	this.connection = function() { return connection; };

	this.where = function(wher ...</pre></li>
    <li>example usage<pre class="apidocCodePre">...
	npm install mysql-activerecord


Get started
-----------

	var Db = require(&#x27;mysql-activerecord&#x27;);
	var db = new Db.<span class="apidocCodeKeywordSpan">Adapter</span>({
		server: &#x27;localhost&#x27;,
		username: &#x27;root&#x27;,
		password: &#x27;12345&#x27;,
		database: &#x27;test&#x27;,
		reconnectTimeout: 2000
	});
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.mysql-activerecord.Pool" id="apidoc.element.mysql-activerecord.Pool">
        function <span class="apidocSignatureSpan">mysql-activerecord.</span>Pool
        <span class="apidocSignatureSpan">(settings)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">Pool = function (settings) {
	if (!mysqlPool) {
		var mysql = require(&#x27;mysql&#x27;);

		var poolOption = {
			createConnection: settings.createConnection,
			waitForConnections: settings.waitForConnections,
			connectionLimit: settings.connectionLimit,
			queueLimit: settings.queueLimit
		};
		Object.keys(poolOption).forEach(function (element) {
			// Avoid pool option being used by mysql connection.
			delete settings[element];
			// Also remove undefined elements from poolOption
			if (!poolOption[element]) {
				delete poolOption[element];
			}
		});

		// Confirm settings with Adapter.
		var db = new Adapter(settings);
		var connectionSettings = db.connectionSettings();

		Object.keys(connectionSettings).forEach(function (element) {
			poolOption[element] = connectionSettings[element];
		});

		mysqlPool = mysql.createPool(poolOption);
		mysqlCharset = settings.charset;
	}

	this.pool = function () {
		return mysqlPool;
	};

	this.getNewAdapter = function (responseCallback) {
		mysqlPool.getConnection(function (err, connection) {
			if (err) {
				throw err;
			}
			var adapter = new Adapter({
				pool: {
					pool: mysqlPool,
					enabled: true,
					connection: connection
				},
				charset: mysqlCharset
			});
			responseCallback(adapter);
		});
	};

	this.disconnect = function (responseCallback) {
		this.pool().end(responseCallback);
	};

	return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
Pooling connections
===================

Single or multiple connections can be pooled with the Pool object.

	var Db = require(&#x27;mysql-activerecord&#x27;);

	var pool = new Db.<span class="apidocCodeKeywordSpan">Pool</span>({
		server: &#x27;localhost&#x27;,
		username: &#x27;root&#x27;,
		password: &#x27;12345&#x27;,
		database: &#x27;test&#x27;
	});
	
	pool.getNewAdapter(function(db) {
...</pre></li>
    </ul>


</div>

<div class="apidocFooterDiv">
    [ this document was created with
    <a href="https://github.com/kaizhu256/node-utility2" target="_blank">utility2</a>
    ]
</div>
</div>
